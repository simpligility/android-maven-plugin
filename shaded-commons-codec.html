<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2015-04-15 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20150415" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Android Maven Plugin - 




Clashing versions of Apache Commons Codec</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.1.min.js"></script>

    
    <meta charset="UTF-8" /><!-- [if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"/><![endif] --><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Asciidoctor 1.5.0" />              </head>
        <body class="topBarEnabled">
          
    
    
            
    
        
    <a href="http://github.com/simpligility/android-maven-plugin">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
                

    <div id="topbar" class="navbar navbar-fixed-top ">
      <div class="navbar-inner">
                <div class="container-fluid">
        <a data-target=".nav-collapse" data-toggle="collapse" class="btn btn-navbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
                
                                <ul class="nav">
                          <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Overview <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="index.html"  title="Introduction">Introduction</a>
</li>
                  
                      <li>      <a href="plugin-info.html"  title="Goals">Goals</a>
</li>
                  
                      <li>      <a href="examples.html"  title="Examples">Examples</a>
</li>
                  
                      <li>      <a href="ide-support.html"  title="IDE Support">IDE Support</a>
</li>
                  
                      <li>      <a href="changelog.html"  title="Changelog">Changelog</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">How To's <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="playstore-publisher.html"  title="Publishing to Google Play Store">Publishing to Google Play Store</a>
</li>
                  
                      <li>      <a href="shaded-commons-codec.html"  title="Shading Example">Shading Example</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Community <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="http://groups.google.com/group/maven-android-developers"  title="Maven Android Mailing List">Maven Android Mailing List</a>
</li>
                  
                      <li>      <a href="report-issue.html"  title="Report An Issue">Report An Issue</a>
</li>
                  
                      <li>      <a href="contributing.html"  title="Contributing">Contributing</a>
</li>
                  
                      <li>      <a href="developing.html"  title="Developing">Developing</a>
</li>
                  
                      <li>      <a href="releasing.html"  title="Releasing">Releasing</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Related Projects <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="http://code.google.com/p/maven-android-plugin/"  title="Old Project site on Google Code">Old Project site on Google Code</a>
</li>
                  
                      <li>      <a href="http://rgladwell.github.io/m2e-android/"  title="m2e-android">m2e-android</a>
</li>
                  
                      <li>      <a href="https://projects.eclipse.org/projects/tools.andmore"  title="Andmore">Andmore</a>
</li>
                  
                      <li>      <a href="https://github.com/simpligility/maven-android-sdk-deployer"  title="Maven Android SDK Deployer">Maven Android SDK Deployer</a>
</li>
                  
                      <li>      <a href="https://github.com/simpligility/android-ndk-maven-plugin/"  title="Android NDK Maven Plugin">Android NDK Maven Plugin</a>
</li>
                  
                      <li>      <a href="http://tools.android.com/"  title="Android Tools">Android Tools</a>
</li>
                  
                      <li>      <a href="http://maven.apache.org/"  title="Apache Maven">Apache Maven</a>
</li>
                  
                      <li>      <a href="http://eclipse.org/m2e/"  title="M2Eclipse">M2Eclipse</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Project Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li class="dropdown-submenu">
                                      <a href="project-info.html"  title="Project Information">Project Information</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="integration.html"  title="Continuous Integration">Continuous Integration</a>
</li>
                                  <li>      <a href="dependencies.html"  title="Dependencies">Dependencies</a>
</li>
                                  <li>      <a href="dependency-convergence.html"  title="Dependency Convergence">Dependency Convergence</a>
</li>
                                  <li>      <a href="dependency-info.html"  title="Dependency Information">Dependency Information</a>
</li>
                                  <li>      <a href="dependency-management.html"  title="Dependency Management">Dependency Management</a>
</li>
                                  <li>      <a href="distribution-management.html"  title="Distribution Management">Distribution Management</a>
</li>
                                  <li>      <a href="index.html"  title="About">About</a>
</li>
                                  <li>      <a href="issue-tracking.html"  title="Issue Tracking">Issue Tracking</a>
</li>
                                  <li>      <a href="license.html"  title="Project License">Project License</a>
</li>
                                  <li>      <a href="mail-lists.html"  title="Mailing Lists">Mailing Lists</a>
</li>
                                  <li>      <a href="plugin-management.html"  title="Plugin Management">Plugin Management</a>
</li>
                                  <li>      <a href="plugins.html"  title="Project Plugins">Project Plugins</a>
</li>
                                  <li>      <a href="team-list.html"  title="Project Team">Project Team</a>
</li>
                                  <li>      <a href="source-repository.html"  title="Source Repository">Source Repository</a>
</li>
                                  <li>      <a href="project-summary.html"  title="Project Summary">Project Summary</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="project-reports.html"  title="Project Reports">Project Reports</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="plugin-info.html"  title="Plugin Documentation">Plugin Documentation</a>
</li>
                                  <li>      <a href="xref/index.html"  title="Source Xref">Source Xref</a>
</li>
                                  <li>      <a href="xref-test/index.html"  title="Test Source Xref">Test Source Xref</a>
</li>
                                  <li>      <a href="cpd.html"  title="CPD">CPD</a>
</li>
                                  <li>      <a href="pmd.html"  title="PMD">PMD</a>
</li>
                                  <li>      <a href="apidocs/index.html"  title="JavaDocs">JavaDocs</a>
</li>
                                  <li>      <a href="testapidocs/index.html"  title="Test JavaDocs">Test JavaDocs</a>
</li>
                                  <li>      <a href="surefire-report.html"  title="Surefire Report">Surefire Report</a>
</li>
                                  <li>      <a href="cobertura/index.html"  title="Cobertura Test Coverage">Cobertura Test Coverage</a>
</li>
                                  <li>      <a href="findbugs.html"  title="FindBugs">FindBugs</a>
</li>
                              </ul>
            </li>
                          </ul>
      </li>
                  </ul>
          
          
          
                   
                      </div>
          
        </div>
      </div>
    </div>
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Android Maven Plugin - android-maven-plugin</h2>
                </div>
                      </div>
        <div class="pull-right">              <div id="bannerRight">
                                                                                                <img src="" />
                </div>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2015-04-15
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 4.2.0
                      </li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Overview</li>
                              
      <li>
  
                          <a href="index.html" title="Introduction">
          <i class="none"></i>
        Introduction</a>
            </li>
                
      <li>
  
                          <a href="plugin-info.html" title="Goals">
          <i class="none"></i>
        Goals</a>
            </li>
                
      <li>
  
                          <a href="examples.html" title="Examples">
          <i class="none"></i>
        Examples</a>
            </li>
                
      <li>
  
                          <a href="ide-support.html" title="IDE Support">
          <i class="none"></i>
        IDE Support</a>
            </li>
                
      <li>
  
                          <a href="changelog.html" title="Changelog">
          <i class="none"></i>
        Changelog</a>
            </li>
                              <li class="nav-header">How To's</li>
                              
      <li>
  
                          <a href="playstore-publisher.html" title="Publishing to Google Play Store">
          <i class="none"></i>
        Publishing to Google Play Store</a>
            </li>
                
      <li class="active">
  
            <a href="#"><i class="none"></i>Shading Example</a>
          </li>
                              <li class="nav-header">Community</li>
                              
      <li>
  
                          <a href="http://groups.google.com/group/maven-android-developers" class="externalLink" title="Maven Android Mailing List">
          <i class="none"></i>
        Maven Android Mailing List</a>
            </li>
                
      <li>
  
                          <a href="report-issue.html" title="Report An Issue">
          <i class="none"></i>
        Report An Issue</a>
            </li>
                
      <li>
  
                          <a href="contributing.html" title="Contributing">
          <i class="none"></i>
        Contributing</a>
            </li>
                
      <li>
  
                          <a href="developing.html" title="Developing">
          <i class="none"></i>
        Developing</a>
            </li>
                
      <li>
  
                          <a href="releasing.html" title="Releasing">
          <i class="none"></i>
        Releasing</a>
            </li>
                              <li class="nav-header">Related Projects</li>
                              
      <li>
  
                          <a href="http://code.google.com/p/maven-android-plugin/" class="externalLink" title="Old Project site on Google Code">
          <i class="none"></i>
        Old Project site on Google Code</a>
            </li>
                
      <li>
  
                          <a href="http://rgladwell.github.io/m2e-android/" class="externalLink" title="m2e-android">
          <i class="none"></i>
        m2e-android</a>
            </li>
                
      <li>
  
                          <a href="https://projects.eclipse.org/projects/tools.andmore" class="externalLink" title="Andmore">
          <i class="none"></i>
        Andmore</a>
            </li>
                
      <li>
  
                          <a href="https://github.com/simpligility/maven-android-sdk-deployer" class="externalLink" title="Maven Android SDK Deployer">
          <i class="none"></i>
        Maven Android SDK Deployer</a>
            </li>
                
      <li>
  
                          <a href="https://github.com/simpligility/android-ndk-maven-plugin/" class="externalLink" title="Android NDK Maven Plugin">
          <i class="none"></i>
        Android NDK Maven Plugin</a>
            </li>
                
      <li>
  
                          <a href="http://tools.android.com/" class="externalLink" title="Android Tools">
          <i class="none"></i>
        Android Tools</a>
            </li>
                
      <li>
  
                          <a href="http://maven.apache.org/" class="externalLink" title="Apache Maven">
          <i class="none"></i>
        Apache Maven</a>
            </li>
                
      <li>
  
                          <a href="http://eclipse.org/m2e/" class="externalLink" title="M2Eclipse">
          <i class="none"></i>
        M2Eclipse</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                                                                            
      <li>
  
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                                                                                                                                                                                                                                    
      <li>
  
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
                    
                            <form id="search-form" action="http://www.google.com/search" method="get" >
    
  <input value="$sitesearchValue" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=search-form"></script>
          
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            




<h1>Clashing versions of Apache Commons Codec</h1>




<div class="section" id="_the_problem">
<h2 id="_the_problem">The problem</h2>



<p>Even though it is hardly document anywhere Android includes an
outdated version (v1.3) of <a class="externalLink" href="http://commons.apache.org/codec">Apache
Commons Codec</a> (commons-codec) as an
<a class="externalLink" href="https://android.googlesource.com/platform/external/apache-http/">internal
library</a>. The library is not exposed in the Android SDK which means
that app developers who want to rely on it in their own apps need to
treat it as an addition dependency and include the library classes
in APK. However, at runtime Android will always favour its internal
commons-codec version instead of the one included by an app. This
causes trouble when app code tries to call methods that exist in the
commons-codec version the developer expected to be using (e.g. v1.9,
which is the current one) but not in Android&#x2019;s outdated version (which
remains are v1.3). Annoyingly there is no compile time indication of
the trouble that lies ahead.</p>



<p>For example, when app code tries to call a commons-codec method
which was introduced in v1.4, the following error is thrown:</p>




<div>
<pre>  10-13 16:22:39.361: I/dalvikvm(3776): Could not find method org.apache.commons.codec.binary.Hex.encodeHexString, referenced from method ...</pre></div>





</div>
<div class="section" id="_the_solution">
<h2 id="_the_solution">The solution</h2>



<p>Using <a class="externalLink" href="http://maven.apache.org">maven</a> and the
<a class="externalLink" href="http://maven.apache.org/plugins/maven-shade-plugin">maven-shading-plugin</a>
it is possible to work around this problem in a fairly elegant way by
&quot;shading&quot; the commons-codec library, which means its package name is
changed to avoid the clash with Android&#x2019;s version.</p>


Steps to follow:

<ol class="arabic" style="list-style-type: decimal">

<li>

<p>Copy this and save as a <i>pom.xml</i> file somewhere on your system&#x2026;&#x200b;</p>



<div>
<pre class="highlight"><tt>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;
   &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
   &lt;groupId&gt;commons-codec&lt;/groupId&gt;
   &lt;artifactId&gt;commons-codec-shaded&lt;/artifactId&gt;
   &lt;name&gt;Apache Commons Codec (shaded)&lt;/name&gt;
   &lt;!-- The version of this project specifies the Apache Commons Codec version which will
       be used, it must therefore match an existing (and preferably current) version. --&gt;
   &lt;version&gt;1.9&lt;/version&gt;
   &lt;packaging&gt;jar&lt;/packaging&gt;
   &lt;!--
     *************************************************************
      Rationale for this &quot;shaded&quot; version of Apache Commons Codec
     *************************************************************
     Context:
       Android includes an outdated version (v1.3) of commons-codec as an internal library.
       This library is not exposed in the Android SDK so app developers who want to rely on
       commons-codec need to treat it as an addition dependency and include it in the APK
       of their app. However, at runtime Android will always favour its internal version of
       the library which causes trouble when app code tries to call methods that don't
       exist in v1.3 but do exist in the version the developer expected to be using.
     Solution:
       After experimenting with many different variations the current (and final) solution
       to this problem is implemented in this project and does not require big hacks or
       changes in projects which depend on commons-codec, expect for declaring dependency
       on commons-codec-shaded (i.e. this project) instead of the original commons-codec.
       What we do here is take the &quot;original&quot; commons-codec library (currently version 1.9)
       and use the maven-shade-plugin to &quot;shade&quot; it, which means we modify the package name
       of the library (both in the compiled classes and the sources jar) in order to avoid
       the clash with Android's version. The package name is changed from
       &quot;org.apache.commons.codec&quot; to &quot;shaded.org.apache.commons.codec&quot;. The result is
       published to the local Maven repository for other projects to use by simple
       dependency declaration on this project. Because we only apply the shading to
       commons-codec itself (and not to other projects/classes using it; which in fact is
       possible using the shade plug-in but breaks in combination with android-maven-plugin)
       any client classes which make use of commons-codec will have to import the new
       &quot;shaded&quot; package name instead of the old one.
     Issue on android-maven-plugin github which I posted to discuss all this:
       https://github.com/jayway/maven-android-plugin/issues/487
   --&gt;
   &lt;description&gt;
     The Apache Commons Codec package contains simple encoder and decoders for
     various formats such as Base64 and Hexadecimal.  In addition to these
     widely used encoders and decoders, the codec package also maintains a
     collection of phonetic encoding utilities.
    &lt;/description&gt;
   &lt;url&gt;http://commons.apache.org/proper/commons-codec/&lt;/url&gt;
   &lt;organization&gt;
      &lt;name&gt;The Apache Software Foundation&lt;/name&gt;
      &lt;url&gt;http://www.apache.org/&lt;/url&gt;
   &lt;/organization&gt;
   &lt;licenses&gt;
      &lt;license&gt;
         &lt;name&gt;The Apache Software License, Version 2.0&lt;/name&gt;
         &lt;url&gt;http://www.apache.org/licenses/LICENSE-2.0.txt&lt;/url&gt;
         &lt;distribution&gt;repo&lt;/distribution&gt;
      &lt;/license&gt;
   &lt;/licenses&gt;
   &lt;contributors&gt;
      &lt;contributor&gt;
         &lt;name&gt;Matthias Stevens&lt;/name&gt;
         &lt;email&gt;m.stevens {at} ucl.ac.uk&lt;/email&gt;
         &lt;roles&gt;
            &lt;role&gt;Shading for use on Android&lt;/role&gt;
         &lt;/roles&gt;
      &lt;/contributor&gt;
      &lt;!-- see commons-codec:commons-codec pom for original contributors/developers --&gt;
   &lt;/contributors&gt;
   &lt;properties&gt;
      &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
      &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
      &lt;maven.compiler.source&gt;1.6&lt;/maven.compiler.source&gt;
      &lt;maven.compiler.target&gt;1.6&lt;/maven.compiler.target&gt;
      &lt;commons-codec-package&gt;org.apache.commons.codec&lt;/commons-codec-package&gt;
      &lt;shading.prefix&gt;shaded&lt;/shading.prefix&gt;
      &lt;shaded-commons-codec-package&gt;${shading.prefix}.${commons-codec-package}&lt;/shaded-commons-codec-package&gt;
      &lt;commons-codec-src-folder&gt;${project.build.directory}/commons-codec-src&lt;/commons-codec-src-folder&gt;
      &lt;commons-codec-res-folder&gt;${project.build.directory}/commons-codec-res&lt;/commons-codec-res-folder&gt;
      &lt;manifest.path&gt;${project.build.directory}/MANIFEST.MF&lt;/manifest.path&gt;
      &lt;!-- plugin versions --&gt;
      &lt;dependency-plugin-version&gt;2.9&lt;/dependency-plugin-version&gt;
      &lt;compiler-plugin-version&gt;3.2&lt;/compiler-plugin-version&gt;
      &lt;antrun-plugin-version&gt;1.7&lt;/antrun-plugin-version&gt;
      &lt;jar-plugin-version&gt;2.5&lt;/jar-plugin-version&gt;
      &lt;source-plugin-version&gt;2.4&lt;/source-plugin-version&gt;
      &lt;shade-plugin-version&gt;2.3&lt;/shade-plugin-version&gt;
      &lt;bundle-plugin-version&gt;2.5.3&lt;/bundle-plugin-version&gt;
      &lt;!-- taken/modified from: http://svn.apache.org/repos/asf/commons/proper/commons-parent/trunk/pom.xml --&gt;
      &lt;commons.osgi.symbolicName&gt;${shaded-commons-codec-package}&lt;/commons.osgi.symbolicName&gt;
      &lt;commons.osgi.export&gt;${shaded-commons-codec-package}.*;version=${project.version};-noimport:=true&lt;/commons.osgi.export&gt;
      &lt;commons.osgi.import&gt;*&lt;/commons.osgi.import&gt;
      &lt;commons.osgi.dynamicImport /&gt;
      &lt;commons.osgi.private /&gt;
   &lt;/properties&gt;
   &lt;build&gt;
      &lt;finalName&gt;${project.artifactId}&lt;/finalName&gt;
      &lt;sourceDirectory&gt;${commons-codec-src-folder}&lt;/sourceDirectory&gt;
      &lt;resources&gt;
         &lt;resource&gt;
            &lt;!-- txt files in shaded\org\apache\commons\codec\language\bm --&gt;
            &lt;directory&gt;${commons-codec-res-folder}&lt;/directory&gt;
            &lt;includes&gt;
               &lt;include&gt;${shading.prefix}/**/*.txt&lt;/include&gt;
            &lt;/includes&gt;
         &lt;/resource&gt;
         &lt;resource&gt;
            &lt;!-- LICENSE &amp; NOTICE files --&gt;
            &lt;directory&gt;${commons-codec-res-folder}/META-INF&lt;/directory&gt;
            &lt;targetPath&gt;META-INF&lt;/targetPath&gt;
            &lt;includes&gt;
               &lt;include&gt;*.txt&lt;/include&gt;
            &lt;/includes&gt;
         &lt;/resource&gt;
      &lt;/resources&gt;
      &lt;plugins&gt;
         &lt;plugin&gt;
            &lt;!-- fetch &amp; unpack commons-codec sources and resources --&gt;
            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
            &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;
            &lt;version&gt;${dependency-plugin-version}&lt;/version&gt;
            &lt;executions&gt;
               &lt;execution&gt;
                  &lt;id&gt;unpack_commons-codec_sources_and_resources&lt;/id&gt;
                  &lt;phase&gt;process-sources&lt;/phase&gt;
                  &lt;goals&gt;
                     &lt;goal&gt;unpack&lt;/goal&gt;
                  &lt;/goals&gt;
                  &lt;configuration&gt;
                     &lt;artifactItems&gt;
                        &lt;!-- commons-codec sources --&gt;
                        &lt;artifactItem&gt;
                           &lt;groupId&gt;commons-codec&lt;/groupId&gt;
                           &lt;artifactId&gt;commons-codec&lt;/artifactId&gt;
                           &lt;!-- the project version specifies the commons-codec version to use: --&gt;
                           &lt;version&gt;${project.version}&lt;/version&gt;
                           &lt;classifier&gt;sources&lt;/classifier&gt;
                           &lt;overWrite&gt;true&lt;/overWrite&gt;
                           &lt;excludes&gt;**/*.txt,META-INF/*&lt;/excludes&gt;
                           &lt;outputDirectory&gt;${commons-codec-src-folder}&lt;/outputDirectory&gt;
                        &lt;/artifactItem&gt;
                        &lt;!-- commons-codec resources (in package) --&gt;
                        &lt;artifactItem&gt;
                           &lt;groupId&gt;commons-codec&lt;/groupId&gt;
                           &lt;artifactId&gt;commons-codec&lt;/artifactId&gt;
                           &lt;!-- the project version specifies the commons-codec version to use: --&gt;
                           &lt;version&gt;${project.version}&lt;/version&gt;
                           &lt;classifier&gt;sources&lt;/classifier&gt;
                           &lt;overWrite&gt;true&lt;/overWrite&gt;
                           &lt;includes&gt;org/**/*.txt&lt;/includes&gt;
                           &lt;!-- apply shading: --&gt;
                           &lt;outputDirectory&gt;${commons-codec-res-folder}/${shading.prefix}&lt;/outputDirectory&gt;
                        &lt;/artifactItem&gt; --&gt;
                        &lt;!-- commons-codec resources (in META-INF) --&gt;
                        &lt;artifactItem&gt;
                           &lt;groupId&gt;commons-codec&lt;/groupId&gt;
                           &lt;artifactId&gt;commons-codec&lt;/artifactId&gt;
                           &lt;!-- the project version specifies the commons-codec version to use: --&gt;
                           &lt;version&gt;${project.version}&lt;/version&gt;
                           &lt;classifier&gt;sources&lt;/classifier&gt;
                           &lt;overWrite&gt;true&lt;/overWrite&gt;
                           &lt;includes&gt;META-INF/*.txt&lt;/includes&gt;
                           &lt;outputDirectory&gt;${commons-codec-res-folder}&lt;/outputDirectory&gt;
                        &lt;/artifactItem&gt; --&gt;
                     &lt;/artifactItems&gt;
                  &lt;/configuration&gt;
               &lt;/execution&gt;
            &lt;/executions&gt;
         &lt;/plugin&gt;
         &lt;plugin&gt;
            &lt;!-- compile commons-codec sources --&gt;
            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
            &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
            &lt;version&gt;${compiler-plugin-version}&lt;/version&gt;
            &lt;configuration&gt;
                  &lt;source&gt;${maven.compiler.source}&lt;/source&gt;
                  &lt;target&gt;${maven.compiler.target}&lt;/target&gt;
               &lt;encoding&gt;UTF-8&lt;/encoding&gt;
            &lt;/configuration&gt;
         &lt;/plugin&gt;
         &lt;plugin&gt;
            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
            &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;
            &lt;version&gt;${jar-plugin-version}&lt;/version&gt;
            &lt;executions&gt;
               &lt;execution&gt;
                  &lt;!-- jar unshaded classes (&amp; resources) --&gt;
                  &lt;id&gt;jar-unshaded&lt;/id&gt;
                  &lt;phase&gt;package&lt;/phase&gt;
                  &lt;goals&gt;
                     &lt;goal&gt;jar&lt;/goal&gt;
                  &lt;/goals&gt;
               &lt;/execution&gt;
               &lt;execution&gt;
                  &lt;!-- rejar shaded classes (&amp; resources), with proper manifest partially generated by bundle plugin --&gt;
                  &lt;id&gt;jar-shaded&lt;/id&gt;
                  &lt;!-- runs after bundle plugin is done generating the bundle manifest --&gt;
                  &lt;phase&gt;post-integration-test&lt;/phase&gt;
                  &lt;goals&gt;
                     &lt;goal&gt;jar&lt;/goal&gt;
                  &lt;/goals&gt;
                  &lt;configuration&gt;
                     &lt;archive&gt;
                        &lt;manifestFile&gt;${manifest.path}&lt;/manifestFile&gt;
                        &lt;manifestEntries&gt;
                           &lt;Specification-Title&gt;${project.name}&lt;/Specification-Title&gt;
                           &lt;Specification-Version&gt;${project.version}&lt;/Specification-Version&gt;
                           &lt;Specification-Vendor&gt;${project.organization.name}&lt;/Specification-Vendor&gt;
                           &lt;Implementation-Title&gt;${project.name}&lt;/Implementation-Title&gt;
                           &lt;Implementation-Version&gt;${project.version}&lt;/Implementation-Version&gt;
                           &lt;Implementation-Vendor&gt;${project.organization.name}&lt;/Implementation-Vendor&gt;
                           &lt;Implementation-Vendor-Id&gt;org.apache&lt;/Implementation-Vendor-Id&gt;
                           &lt;Implementation-Build&gt;${implementation.build}&lt;/Implementation-Build&gt;
                           &lt;X-Compile-Source-JDK&gt;${maven.compiler.source}&lt;/X-Compile-Source-JDK&gt;
                           &lt;X-Compile-Target-JDK&gt;${maven.compiler.target}&lt;/X-Compile-Target-JDK&gt;
                        &lt;/manifestEntries&gt;
                     &lt;/archive&gt;
                  &lt;/configuration&gt;
               &lt;/execution&gt;
            &lt;/executions&gt;
         &lt;/plugin&gt;
         &lt;plugin&gt;
            &lt;!-- attach sources jar --&gt;
            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
            &lt;artifactId&gt;maven-source-plugin&lt;/artifactId&gt;
            &lt;version&gt;${source-plugin-version}&lt;/version&gt;
            &lt;configuration&gt;
               &lt;archive&gt;
                  &lt;manifest&gt;
                     &lt;addDefaultImplementationEntries&gt;true&lt;/addDefaultImplementationEntries&gt;
                     &lt;addDefaultSpecificationEntries&gt;true&lt;/addDefaultSpecificationEntries&gt;
                  &lt;/manifest&gt;
               &lt;/archive&gt;
            &lt;/configuration&gt;
            &lt;executions&gt;
               &lt;execution&gt;
                  &lt;!-- jar unshaded sources --&gt;
                  &lt;id&gt;attach-unshaded-sources&lt;/id&gt;
                  &lt;!-- &lt;phase&gt;package&lt;/phase&gt; (default) --&gt;
                  &lt;goals&gt;
                     &lt;goal&gt;jar&lt;/goal&gt;
                  &lt;/goals&gt;
               &lt;/execution&gt;
               &lt;execution&gt;
                  &lt;!-- rejar shaded sources --&gt;
                  &lt;id&gt;attach-shaded-sources&lt;/id&gt;
                  &lt;phase&gt;post-integration-test&lt;/phase&gt;
                  &lt;goals&gt;
                     &lt;goal&gt;jar&lt;/goal&gt;
                  &lt;/goals&gt;
               &lt;/execution&gt;
            &lt;/executions&gt;
         &lt;/plugin&gt;
         &lt;plugin&gt;
            &lt;!-- apply the shading to main jar and sources jar --&gt;
            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
            &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;
            &lt;version&gt;${shade-plugin-version}&lt;/version&gt;
            &lt;executions&gt;
               &lt;execution&gt;
                  &lt;id&gt;shading-main-jar-and-sources-jar&lt;/id&gt;
                  &lt;phase&gt;package&lt;/phase&gt;
                  &lt;goals&gt;
                     &lt;goal&gt;shade&lt;/goal&gt;
                  &lt;/goals&gt;
                  &lt;configuration&gt;
                     &lt;!-- (not needed as it is the one and only artifact/dependency)
                     &lt;artifactSet&gt;
                        &lt;includes&gt;
                           &lt;include&gt;commons-codec:*&lt;/include&gt;
                        &lt;/includes&gt;
                     &lt;/artifactSet&gt;
                     --&gt;
                     &lt;relocations&gt;
                        &lt;relocation&gt;
                           &lt;pattern&gt;${commons-codec-package}&lt;/pattern&gt;
                           &lt;shadedPattern&gt;${shaded-commons-codec-package}&lt;/shadedPattern&gt;
                        &lt;/relocation&gt;
                     &lt;/relocations&gt;
                     &lt;createDependencyReducedPom&gt;false&lt;/createDependencyReducedPom&gt;
                     &lt;!-- (only needed when dependency reduced pom is generated)
                     &lt;dependencyReducedPomLocation&gt;${project.build.directory}/dependency-reduced-pom.xml&lt;/dependencyReducedPomLocation&gt;
                     &lt;keepDependenciesWithProvidedScope&gt;true&lt;/keepDependenciesWithProvidedScope&gt;
                     &lt;promoteTransitiveDependencies&gt;true&lt;/promoteTransitiveDependencies&gt;
                     --&gt;
                     &lt;createSourcesJar&gt;true&lt;/createSourcesJar&gt;
                     &lt;shadeSourcesContent&gt;true&lt;/shadeSourcesContent&gt;
                  &lt;/configuration&gt;
               &lt;/execution&gt;
            &lt;/executions&gt;
         &lt;/plugin&gt;
         &lt;plugin&gt;
            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
            &lt;artifactId&gt;maven-antrun-plugin&lt;/artifactId&gt;
            &lt;version&gt;${antrun-plugin-version}&lt;/version&gt;
            &lt;executions&gt;
               &lt;execution&gt;
                  &lt;!-- unpack shaded classes &amp; sources for manifest generation and re-jarring --&gt;
                  &lt;id&gt;post-shading-tasks&lt;/id&gt;
                  &lt;phase&gt;package&lt;/phase&gt;
                  &lt;goals&gt;
                     &lt;goal&gt;run&lt;/goal&gt;
                  &lt;/goals&gt;
                  &lt;configuration&gt;
                     &lt;target&gt;
                        &lt;!-- Unjar shaded classes for generation of manifest --&gt;
                        &lt;echo&gt;Deleting unshaded classes...&lt;/echo&gt;
                        &lt;delete dir=&quot;${project.build.directory}/classes&quot;/&gt;
                        &lt;echo&gt;Unjarring shaded main jar...&lt;/echo&gt;
                        &lt;unzip src=&quot;${project.build.directory}/${project.artifactId}.jar&quot; dest=&quot;${project.build.directory}/classes&quot;/&gt;
                        &lt;!-- delete to prevent dual inclusion in new main jar --&gt;
                        &lt;delete dir=&quot;${project.build.directory}/classes/META-INF/maven&quot;/&gt;
                        &lt;!-- Unjar shaded sources --&gt;
                        &lt;echo&gt;Deleting unshaded sources...&lt;/echo&gt;
                        &lt;delete dir=&quot;${commons-codec-src-folder}&quot;/&gt;
                        &lt;echo&gt;Unjarring shaded sources jar...&lt;/echo&gt;
                        &lt;unzip src=&quot;${project.build.directory}/${project.artifactId}-sources.jar&quot; dest=&quot;${commons-codec-src-folder}&quot;/&gt;
                        &lt;!-- delete to prevent dual inclusion in new sources jar --&gt;
                        &lt;delete dir=&quot;${commons-codec-src-folder}/META-INF&quot;/&gt;
                     &lt;/target&gt;
                  &lt;/configuration&gt;
               &lt;/execution&gt;
                &lt;execution&gt;
                     &lt;id&gt;delete-orginals&lt;/id&gt;
                     &lt;phase&gt;verify&lt;/phase&gt;
                     &lt;goals&gt;
                        &lt;goal&gt;run&lt;/goal&gt;
                     &lt;/goals&gt;
                     &lt;configuration&gt;
                        &lt;target&gt;
                           &lt;echo&gt;Deleting unshaded jar files...&lt;/echo&gt;
                           &lt;delete&gt;
                              &lt;fileset dir=&quot;${project.build.directory}&quot; includes=&quot;**/original-*.jar&quot; /&gt;
                           &lt;/delete&gt;
                        &lt;/target&gt;
                     &lt;/configuration&gt;
               &lt;/execution&gt;
            &lt;/executions&gt;
         &lt;/plugin&gt;
         &lt;plugin&gt;
            &lt;!-- taken/modified from: http://svn.apache.org/repos/asf/commons/proper/commons-parent/trunk/pom.xml --&gt;
            &lt;groupId&gt;org.apache.felix&lt;/groupId&gt;
            &lt;artifactId&gt;maven-bundle-plugin&lt;/artifactId&gt;
            &lt;version&gt;${bundle-plugin-version}&lt;/version&gt;
            &lt;configuration&gt;
               &lt;archive&gt;
                  &lt;forced&gt;true&lt;/forced&gt;
               &lt;/archive&gt;
               &lt;excludeDependencies&gt;true&lt;/excludeDependencies&gt;
               &lt;manifestLocation&gt;${project.build.directory}&lt;/manifestLocation&gt;
               &lt;instructions&gt;
                  &lt;!-- stops the &quot;uses&quot; clauses being added to &quot;Export-Package&quot; manifest entry --&gt;
                  &lt;_nouses&gt;true&lt;/_nouses&gt;
                  &lt;!-- Stop the JAVA_1_n_HOME variables from being treated as headers by Bnd --&gt;
                  &lt;_removeheaders&gt;JAVA_1_3_HOME,JAVA_1_4_HOME,JAVA_1_5_HOME,JAVA_1_6_HOME,JAVA_1_7_HOME,JAVA_1_8_HOME&lt;/_removeheaders&gt;
                  &lt;Bundle-SymbolicName&gt;${commons.osgi.symbolicName}&lt;/Bundle-SymbolicName&gt;
                  &lt;Export-Package&gt;${commons.osgi.export}&lt;/Export-Package&gt;
                  &lt;Private-Package&gt;${commons.osgi.private}&lt;/Private-Package&gt;
                  &lt;Import-Package&gt;${commons.osgi.import}&lt;/Import-Package&gt;
                  &lt;DynamicImport-Package&gt;${commons.osgi.dynamicImport}&lt;/DynamicImport-Package&gt;
                  &lt;Bundle-DocURL&gt;${project.url}&lt;/Bundle-DocURL&gt;
               &lt;/instructions&gt;
            &lt;/configuration&gt;
            &lt;executions&gt;
               &lt;execution&gt;
                  &lt;id&gt;bundle-manifest&lt;/id&gt;
                  &lt;!-- runs after the unjarring of the shaded classes --&gt;
                  &lt;phase&gt;integration-test&lt;/phase&gt;&lt;!--  default is: process-classes --&gt;
                  &lt;goals&gt;
                     &lt;goal&gt;manifest&lt;/goal&gt;
                  &lt;/goals&gt;
               &lt;/execution&gt;
            &lt;/executions&gt;
         &lt;/plugin&gt;
      &lt;/plugins&gt;
   &lt;/build&gt;
&lt;/project&gt;</tt></pre></div>


</li>
</ol>



<p>[NOTE] You can also base the shaded library on another version of
commons-codec by simply changing the version of the
shaded-commons-codec project.</p>



<ol class="arabic" style="list-style-type: decimal">

<li>

<p>Run mvn install on the command line while in the directory where
the <i>pom.xml</i> sits. This will install the &quot;shaded&quot; version of
commons-codec to your local Maven repository.</p>
</li>

<li>

<p>Now open the <i>pom.xml</i> file of any Android-targeting project (jar,
apk, apklib or aar) in which you want to make use of commons-codec
and replace&#x2026;&#x200b;</p>
</li>
</ol>




<div>
<pre class="highlight"><tt>   &lt;!-- this: --&gt;
   &lt;dependency&gt;
      &lt;groupId&gt;commons-codec&lt;/groupId&gt;
      &lt;artifactId&gt;commons-codec&lt;/artifactId&gt;
      &lt;version&gt;1.9&lt;/version&gt;&lt;!-- or whatever version you were using --&gt;
   &lt;/dependency&gt;
   &lt;!-- by this: --&gt;
   &lt;dependency&gt;
      &lt;groupId&gt;commons-codec&lt;/groupId&gt;
      &lt;artifactId&gt;commons-codec-shaded&lt;/artifactId&gt;
      &lt;version&gt;1.9&lt;/version&gt;&lt;!-- or whatever version you based your shaded library on --&gt;
   &lt;/dependency&gt;</tt></pre></div>







Last updated 2015-04-15 15:10:28 PDT


</div>

                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                              <p >Copyright &copy;                    2008&#x2013;2015
                        <a href="http://www.simpligility.com">simpligility technologies inc.</a>.
            All rights reserved.      
                    
      </p>
        </div>

        
        
                </div>
    </footer>
        </body>
</html>
